import"./chunks/modulepreload-polyfill-B5Qt9EMX.js";import{r as u,j as e,c as N}from"./chunks/globals-DhEz86-d.js";const w={ui:{activeSection:"chatbox",leftNavCollapsed:!1,rightSidebarVisible:!0},chat:{messages:[],sources:[],isLoading:!1},mcp:{connections:[],isLoading:!1},autoConnect:{rules:[],isLoading:!1}};function C(t,s){switch(s.type){case"SET_ACTIVE_SECTION":return{...t,ui:{...t.ui,activeSection:s.payload,rightSidebarVisible:s.payload==="chatbox"}};case"TOGGLE_LEFT_NAV":return{...t,ui:{...t.ui,leftNavCollapsed:!t.ui.leftNavCollapsed}};case"SET_RIGHT_SIDEBAR_VISIBLE":return{...t,ui:{...t.ui,rightSidebarVisible:s.payload}};case"ADD_CHAT_MESSAGE":return{...t,chat:{...t.chat,messages:[...t.chat.messages,s.payload]}};case"SET_CHAT_LOADING":return{...t,chat:{...t.chat,isLoading:s.payload}};case"SET_CHAT_SOURCES":return{...t,chat:{...t.chat,sources:s.payload}};case"SET_MCP_CONNECTIONS":return{...t,mcp:{...t.mcp,connections:s.payload}};case"SET_MCP_LOADING":return{...t,mcp:{...t.mcp,isLoading:s.payload}};case"UPDATE_MCP_CONNECTION":return{...t,mcp:{...t.mcp,connections:t.mcp.connections.map(a=>a.id===s.payload.id?{...a,...s.payload.updates}:a)}};case"SET_AUTOCONNECT_RULES":return{...t,autoConnect:{...t.autoConnect,rules:s.payload}};case"SET_AUTOCONNECT_LOADING":return{...t,autoConnect:{...t.autoConnect,isLoading:s.payload}};case"UPDATE_AUTOCONNECT_RULE":return{...t,autoConnect:{...t.autoConnect,rules:t.autoConnect.rules.map(a=>a.id===s.payload.id?{...a,...s.payload.updates}:a)}};case"LOAD_STATE":return{...t,...s.payload};default:return t}}const b=u.createContext(null),k=({children:t})=>{const[s,a]=u.useReducer(C,w);return u.useEffect(()=>{chrome.storage.sync.get(["activeSection","leftNavCollapsed","chatMessages","chatSources","mcpConnections","autoConnectRules"],r=>{r.activeSection&&a({type:"LOAD_STATE",payload:{ui:{activeSection:r.activeSection||"chatbox",leftNavCollapsed:r.leftNavCollapsed||!1,rightSidebarVisible:(r.activeSection||"chatbox")==="chatbox"},chat:{messages:r.chatMessages||[],sources:r.chatSources||[],isLoading:!1},mcp:{connections:r.mcpConnections||[],isLoading:!1},autoConnect:{rules:r.autoConnectRules||[],isLoading:!1}}})})},[]),u.useEffect(()=>{chrome.storage.sync.set({activeSection:s.ui.activeSection,leftNavCollapsed:s.ui.leftNavCollapsed,chatMessages:s.chat.messages,chatSources:s.chat.sources,mcpConnections:s.mcp.connections,autoConnectRules:s.autoConnect.rules})},[s]),e.jsx(b.Provider,{value:{state:s,dispatch:a},children:t})},p=()=>{const t=u.useContext(b);if(!t)throw new Error("useAppContext must be used within an AppProvider");return t},S=({leftNavCollapsed:t,rightSidebarVisible:s,children:a,leftNavigation:r,rightSidebar:l})=>{const o=s&&l;return e.jsxs("div",{className:"h-screen bg-gray-900 text-white flex overflow-hidden relative",children:[e.jsx("div",{className:`
        bg-gray-800 border-r border-gray-700 transition-all duration-300 flex-shrink-0
        ${t?"w-16":"w-64"}
      `,children:r}),e.jsxs("div",{className:"flex-1 flex min-w-0 relative",children:[e.jsx("div",{className:"flex-1 overflow-hidden relative",children:a}),o&&e.jsx("div",{className:"flex-shrink-0",children:l})]})]})},L=[{id:"chatbox",icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),label:"ChatBox",tooltip:"Trò chuyện với AI"},{id:"mcp",icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),label:"MCP Management",tooltip:"Quản lý Kết nối MCP"},{id:"autoconnect",icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),label:"Auto-Connect",tooltip:"Tác nhận tự động"}],T=()=>{const{state:t,dispatch:s}=p(),{activeSection:a,leftNavCollapsed:r}=t.ui,l=i=>{s({type:"SET_ACTIVE_SECTION",payload:i})},o=()=>{s({type:"TOGGLE_LEFT_NAV"})};return e.jsxs("div",{className:"h-full flex flex-col bg-gray-800",children:[e.jsx("div",{className:"p-4 border-b border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[!r&&e.jsx("h1",{className:"text-lg font-semibold text-white",children:"Extension"}),e.jsx("button",{onClick:o,className:"p-2 rounded-lg hover:bg-gray-700 transition-colors text-gray-400 hover:text-white",title:r?"Expand sidebar":"Collapse sidebar",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:r?"M9 5l7 7-7 7":"M15 19l-7-7 7-7"})})})]})}),e.jsx("nav",{className:"flex-1 p-4",children:e.jsx("ul",{className:"space-y-2",children:L.map(i=>e.jsx("li",{children:e.jsxs("button",{onClick:()=>l(i.id),className:`
                  w-full flex items-center p-3 rounded-lg transition-all duration-200
                  ${a===i.id?"bg-blue-600 text-white shadow-lg":"text-gray-300 hover:bg-gray-700 hover:text-white"}
                  ${r?"justify-center":"justify-start"}
                `,title:r?i.tooltip:"",children:[e.jsx("span",{className:"flex-shrink-0",children:i.icon}),!r&&e.jsx("span",{className:"ml-3 text-sm font-medium",children:i.label})]})},i.id))})}),e.jsx("div",{className:"p-4 border-t border-gray-700",children:e.jsxs("div",{className:`flex items-center ${r?"justify-center":"justify-between"}`,children:[!r&&e.jsx("div",{className:"text-xs text-gray-400",children:"v1.0.0"}),e.jsx("button",{className:"p-2 rounded-lg hover:bg-gray-700 transition-colors text-gray-400 hover:text-white",title:"Settings",children:e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})})]})})]})},M=({visible:t,content:s,sources:a=[]})=>{if(!t||s==="none")return null;const r=i=>{switch(i){case"document":return"📄";case"file":return"📁";case"web":return"🌐";case"chat":return"💬";default:return"📄"}},l=i=>i?` • ${i}`:"",o=i=>{const d=new Date,c=new Date(i),n=d.getTime()-c.getTime(),x=Math.floor(n/(1e3*60)),h=Math.floor(n/(1e3*60*60)),m=Math.floor(n/(1e3*60*60*24));return x<1?"Vừa xong":x<60?`${x} phút trước`:h<24?`${h} giờ trước`:`${m} ngày trước`};return e.jsx("div",{className:"w-80 sm:w-72 md:w-80 bg-gray-800 border-l border-gray-700 flex-shrink-0 h-full overflow-hidden",children:s==="sources"&&e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("div",{className:"p-4 border-b border-gray-700",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Nguồn gần đây"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Tài liệu và tệp đã sử dụng"})]})})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:a.length===0?e.jsxs("div",{className:"p-4 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-700 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Chưa có nguồn dữ liệu nào"})]}):e.jsx("div",{className:"p-4 space-y-3",children:a.map(i=>e.jsx("div",{className:"bg-gray-700 rounded-lg p-3 hover:bg-gray-600 transition-colors cursor-pointer",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("span",{className:"text-lg flex-shrink-0 mt-0.5",children:r(i.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-sm font-medium text-white truncate",children:i.name}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[o(i.timestamp),l(i.size)]}),i.path&&e.jsx("p",{className:"text-xs text-gray-500 mt-1 truncate",children:i.path})]})]})},i.id))})}),e.jsxs("div",{className:"p-4 space-y-3 border-t border-gray-700",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-300 mb-3",children:"Tài liệu mẫu"}),e.jsx("div",{className:"bg-gray-700 rounded-lg p-3 hover:bg-gray-600 transition-colors cursor-pointer",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("span",{className:"text-lg flex-shrink-0 mt-0.5",children:"📄"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-sm font-medium text-white",children:"Banking Terms"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Credit_Default_Swap.pdf"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Sử dụng 2 phút trước"})]})]})}),e.jsx("div",{className:"bg-gray-700 rounded-lg p-3 hover:bg-gray-600 transition-colors cursor-pointer",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("span",{className:"text-lg flex-shrink-0 mt-0.5",children:"📊"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-sm font-medium text-white",children:"Finance Docs"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"derivatives_overview.docx"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Sử dụng 15 phút trước"})]})]})}),e.jsx("div",{className:"bg-gray-700 rounded-lg p-3 hover:bg-gray-600 transition-colors cursor-pointer",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("span",{className:"text-lg flex-shrink-0 mt-0.5",children:"💬"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-sm font-medium text-white",children:"Team Chat"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"#finance-discussion"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Sử dụng 1 giờ trước"})]})]})})]})]})})},D=({message:t})=>{const s=t.sender==="user";return e.jsx("div",{className:`flex ${s?"justify-end":"justify-start"} mb-4`,children:e.jsxs("div",{className:`max-w-[80%] ${s?"order-2":"order-1"}`,children:[!s&&e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center mr-2",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),e.jsx("span",{className:"text-sm text-gray-400",children:"AI Assistant"})]}),e.jsxs("div",{className:`
          rounded-2xl px-4 py-3 text-sm
          ${s?"bg-blue-600 text-white rounded-br-md":"bg-gray-800 text-gray-100 rounded-bl-md border border-gray-700"}
        `,children:[e.jsx("p",{className:"whitespace-pre-wrap",children:t.content}),t.sources&&t.sources.length>0&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-600",children:[e.jsx("p",{className:"text-xs text-gray-300 mb-2",children:"Nguồn dữ liệu tham khảo:"}),e.jsx("div",{className:"bg-gray-700 rounded-lg p-2",children:e.jsxs("div",{className:"flex items-center text-xs text-gray-300",children:[e.jsx("span",{className:"mr-2",children:"📄"}),e.jsx("span",{className:"flex-1",children:t.sources[0].name})]})})]})]}),e.jsx("div",{className:`text-xs text-gray-500 mt-1 ${s?"text-right":"text-left"}`,children:new Date(t.timestamp).toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"})})]})})},E=({onSendMessage:t,disabled:s=!1})=>{const[a,r]=u.useState(""),l=u.useRef(null),o=c=>{c.preventDefault(),a.trim()&&!s&&(t(a),r(""),l.current&&(l.current.style.height="auto"))},i=c=>{c.key==="Enter"&&!c.shiftKey&&(c.preventDefault(),o(c))},d=c=>{r(c.target.value),l.current&&(l.current.style.height="auto",l.current.style.height=`${l.current.scrollHeight}px`)};return u.useEffect(()=>{l.current&&l.current.focus()},[]),e.jsxs("form",{onSubmit:o,className:"flex items-end space-x-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("textarea",{ref:l,value:a,onChange:d,onKeyDown:i,placeholder:"Hỏi bất cứ điều gì về nguồn dữ liệu...",disabled:s,className:"w-full bg-gray-800 border border-gray-600 rounded-2xl px-4 py-3 pr-12 text-white placeholder-gray-400 resize-none focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50 disabled:cursor-not-allowed min-h-[48px] max-h-32",rows:1}),e.jsx("button",{type:"button",className:"absolute right-3 bottom-3 p-1 text-gray-400 hover:text-gray-300 transition-colors",title:"Đính kèm tệp",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})})})]}),e.jsx("button",{type:"submit",disabled:!a.trim()||s,className:"flex-shrink-0 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white p-3 rounded-2xl transition-colors",title:"Gửi tin nhắn",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})},y=()=>{const{state:t,dispatch:s}=p(),{messages:a,isLoading:r}=t.chat,{rightSidebarVisible:l}=t.ui,o=u.useRef(null),i=()=>{var n;(n=o.current)==null||n.scrollIntoView({behavior:"smooth"})};u.useEffect(()=>{i()},[a]);const d=()=>{s({type:"SET_RIGHT_SIDEBAR_VISIBLE",payload:!l})},c=async n=>{if(!n.trim())return;const x={id:Date.now().toString(),content:n.trim(),sender:"user",timestamp:new Date};s({type:"ADD_CHAT_MESSAGE",payload:x}),s({type:"SET_CHAT_LOADING",payload:!0}),setTimeout(()=>{const h={id:(Date.now()+1).toString(),content:`Tôi hiểu bạn đã hỏi: "${n}". Đây là một phản hồi mẫu từ AI. Trong thực tế, điều này sẽ được kết nối với một dịch vụ AI thực sự.`,sender:"ai",timestamp:new Date,sources:[{id:"1",name:"Credit_Default_Swap.pdf",type:"document",timestamp:new Date,icon:"📄",size:"2.3 MB"}]};s({type:"ADD_CHAT_MESSAGE",payload:h}),s({type:"SET_CHAT_LOADING",payload:!1})},1500)};return e.jsxs("div",{className:"h-full flex flex-col bg-gray-900",children:[e.jsx("div",{className:"flex-shrink-0 p-4 border-b border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Trò chuyện với AI"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Hỏi bất cứ điều gì về dữ liệu kết nối"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("button",{onClick:d,className:`
                flex items-center text-xs px-3 py-1.5 rounded-full border transition-all duration-200
                ${l?"text-blue-400 bg-blue-500/20 border-blue-500/40 shadow-sm":"text-gray-400 bg-gray-500/10 border-gray-500/20 hover:text-blue-400 hover:bg-blue-500/10 hover:border-blue-500/20"}
              `,title:l?"Ẩn nguồn gần đây":"Hiện nguồn gần đây",children:[e.jsx("svg",{className:"w-3 h-3 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("span",{className:"font-medium",children:"Nguồn"}),e.jsx("div",{className:`w-1.5 h-1.5 rounded-full ml-1.5 transition-colors ${l?"bg-blue-400":"bg-green-500"}`})]}),e.jsx("button",{className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm font-medium transition-colors",children:"+ Cuộc trò chuyện mới"})]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:a.length===0?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-800 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),e.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Bắt đầu cuộc trò chuyện"}),e.jsx("p",{className:"text-gray-400 max-w-md",children:"Hỏi tôi về bất kỳ điều gì liên quan đến dữ liệu của bạn, tài liệu hoặc các kết nối MCP."})]})}):e.jsxs(e.Fragment,{children:[a.map(n=>e.jsx(D,{message:n},n.id)),r&&e.jsxs("div",{className:"flex items-center space-x-2 text-gray-400",children:[e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]}),e.jsx("span",{className:"text-sm",children:"AI đang trả lời..."})]}),e.jsx("div",{ref:o})]})}),e.jsx("div",{className:"flex-shrink-0 p-4 border-t border-gray-700",children:e.jsx(E,{onSendMessage:c,disabled:r})})]})},A=({connection:t,onToggle:s,onConfigure:a,onDelete:r})=>{const l=d=>{switch(d){case"connected":return"text-green-400 bg-green-400/10";case"syncing":return"text-yellow-400 bg-yellow-400/10";case"disconnected":return"text-gray-400 bg-gray-400/10";case"error":return"text-red-400 bg-red-400/10";default:return"text-gray-400 bg-gray-400/10"}},o=d=>{switch(d){case"connected":return"Connected";case"syncing":return"Syncing";case"disconnected":return"Disconnected";case"error":return"Error";default:return"Unknown"}},i=d=>{const c=new Date,n=new Date(d),x=c.getTime()-n.getTime(),h=Math.floor(x/(1e3*60)),m=Math.floor(x/(1e3*60*60)),g=Math.floor(x/(1e3*60*60*24));return h<1?"Just now":h<60?`${h} minutes ago`:m<24?`${m} hour${m>1?"s":""} ago`:`${g} day${g>1?"s":""} ago`};return e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-xl p-6 hover:border-gray-600 transition-all duration-200",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"text-2xl",children:t.icon}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:t.name}),e.jsx("p",{className:"text-sm text-gray-400",children:t.description})]})]}),e.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${l(t.status)}`,children:e.jsxs("div",{className:"flex items-center space-x-1",children:[t.status==="syncing"&&e.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-pulse"}),e.jsx("span",{children:o(t.status)})]})})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("p",{className:"text-xs text-gray-500",children:["Last sync: ",i(t.lastSync)]})}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-700",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:a,className:"p-2 text-gray-400 hover:text-white hover:bg-gray-700 rounded-lg transition-colors",title:"Configure",children:e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}),e.jsx("button",{onClick:r,className:"p-2 text-gray-400 hover:text-red-400 hover:bg-red-400/10 rounded-lg transition-colors",title:"Delete",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),e.jsx("button",{onClick:s,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${t.status==="connected"||t.status==="syncing"?"bg-blue-600":"bg-gray-600"}`,disabled:t.status==="syncing",children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${t.status==="connected"||t.status==="syncing"?"translate-x-6":"translate-x-1"}`})})]})]})},_=()=>{const{state:t}=p(),{connections:s,isLoading:a}=t.mcp,r=[{id:"1",name:"Local Files",type:"local-files",status:"connected",lastSync:new Date(Date.now()-2*60*1e3),description:"Desktop & Documents",icon:"📁",settings:{}},{id:"2",name:"SharePoint",type:"sharepoint",status:"connected",lastSync:new Date(Date.now()-60*60*1e3),description:"Corporate Documents",icon:"🏢",settings:{}},{id:"3",name:"Confluence",type:"confluence",status:"disconnected",lastSync:new Date(Date.now()-3*24*60*60*1e3),description:"Wiki & Knowledge Base",icon:"📚",settings:{}},{id:"4",name:"Google Drive",type:"google-drive",status:"connected",lastSync:new Date(Date.now()-30*60*1e3),description:"Cloud Storage",icon:"☁️",settings:{}},{id:"5",name:"Notion",type:"notion",status:"syncing",lastSync:new Date(Date.now()-5*60*1e3),description:"Workspace & Notes",icon:"📝",settings:{}},{id:"6",name:"Slack",type:"slack",status:"connected",lastSync:new Date(Date.now()-15*60*1e3),description:"Team Communication",icon:"💬",settings:{}}],l=s.length>0?s:r,o=()=>{console.log("Add new connection")},i=n=>{console.log("Toggle connection:",n)},d=n=>{console.log("Configure connection:",n)},c=n=>{console.log("Delete connection:",n)};return a?e.jsx("div",{className:"h-full flex items-center justify-center bg-gray-900",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"Đang tải kết nối MCP..."})]})}):e.jsxs("div",{className:"h-full bg-gray-900 overflow-hidden",children:[e.jsx("div",{className:"flex-shrink-0 p-6 border-b border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-white",children:"Quản lý Kết nối MCP"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Kết nối và quản lý các nguồn dữ liệu bên ngoài"})]}),e.jsxs("button",{onClick:o,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm font-medium transition-colors flex items-center space-x-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),e.jsx("span",{children:"Thêm Kết nối"})]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:l.length===0?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-800 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})})}),e.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Chưa có kết nối nào"}),e.jsx("p",{className:"text-gray-400 max-w-md mb-4",children:"Thêm kết nối MCP để truy cập dữ liệu từ các nguồn bên ngoài như SharePoint, Google Drive, Notion và nhiều hơn nữa."}),e.jsx("button",{onClick:o,className:"px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:"Thêm Kết nối Đầu tiên"})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:l.map(n=>e.jsx(A,{connection:n,onToggle:()=>i(n.id),onConfigure:()=>d(n.id),onDelete:()=>c(n.id)},n.id))})})]})},R=({rule:t,onToggle:s,onEdit:a,onDelete:r})=>{const l=n=>{switch(n){case"translation":return"🌐";case"content-writer":return"✍️";case"data-analysis":return"📊";default:return"⚡"}},o=n=>{switch(n){case"translation":return"bg-blue-500/10 text-blue-400";case"content-writer":return"bg-purple-500/10 text-purple-400";case"data-analysis":return"bg-green-500/10 text-green-400";default:return"bg-gray-500/10 text-gray-400"}},i=n=>n==="active"?"Active":"Inactive",d=n=>{if(!n)return"Never run";const x=new Date,h=new Date(n),m=x.getTime()-h.getTime(),g=Math.floor(m/(1e3*60)),f=Math.floor(m/(1e3*60*60)),j=Math.floor(m/(1e3*60*60*24));return g<1?"Just now":g<60?`${g} minutes ago`:f<24?`${f} hour${f>1?"s":""} ago`:`${j} day${j>1?"s":""} ago`},c=n=>{switch(n.type){case"url-pattern":return`URL matches: ${n.value}`;case"content-type":return`Content type: ${n.value}`;case"schedule":return`Schedule: ${n.value}`;default:return n.value}};return e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-xl p-6 hover:border-gray-600 transition-all duration-200",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"text-2xl mt-1",children:l(t.type)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:t.name}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${o(t.type)}`,children:t.type.replace("-"," ")})]}),e.jsx("p",{className:"text-sm text-gray-400 leading-relaxed",children:t.description})]})]}),e.jsx("button",{onClick:s,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${t.status==="active"?"bg-blue-600":"bg-gray-600"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${t.status==="active"?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Status:"}),e.jsx("span",{className:`font-medium ${t.status==="active"?"text-green-400":"text-gray-400"}`,children:i(t.status)})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Trigger:"}),e.jsx("span",{className:"text-gray-300 text-right max-w-xs truncate",children:c(t.trigger)})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Last run:"}),e.jsx("span",{className:"text-gray-300",children:d(t.lastRun)})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-700",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:a,className:"p-2 text-gray-400 hover:text-white hover:bg-gray-700 rounded-lg transition-colors",title:"Edit Rule",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("button",{onClick:r,className:"p-2 text-gray-400 hover:text-red-400 hover:bg-red-400/10 rounded-lg transition-colors",title:"Delete Rule",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Rule #",t.id]})]})]})},I=()=>{const{state:t}=p(),{rules:s,isLoading:a}=t.autoConnect,r=[{id:"1",name:"Hỗ trợ dịch thuật",description:"Giúp bạn dịch nhanh và chính xác các tài liệu từ nhiều ngôn ngữ khác nhau.",type:"translation",status:"active",trigger:{type:"url-pattern",value:"*translate*"},action:{type:"auto-translate",config:{targetLanguage:"vi"}},lastRun:new Date(Date.now()-30*60*1e3)},{id:"2",name:"Content Writer",description:"Giúp bạn sáng tạo và tối ưu nội dung cho nhiều mục đích khác nhau.",type:"content-writer",status:"active",trigger:{type:"content-type",value:"text/html"},action:{type:"content-optimization",config:{style:"professional"}},lastRun:new Date(Date.now()-2*60*60*1e3)},{id:"3",name:"Phân tích dữ liệu",description:"Giúp bạn phân tích dữ liệu, tạo báo cáo và rút ra những insight quan trọng để hỗ trợ quyết định.",type:"data-analysis",status:"inactive",trigger:{type:"schedule",value:"0 9 * * 1"},action:{type:"data-report",config:{format:"pdf"}}}],l=s.length>0?s:r,o=()=>{console.log("Create new rule")},i=n=>{console.log("Toggle rule:",n)},d=n=>{console.log("Edit rule:",n)},c=n=>{console.log("Delete rule:",n)};return a?e.jsx("div",{className:"h-full flex items-center justify-center bg-gray-900",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"Đang tải quy tắc tự động..."})]})}):e.jsxs("div",{className:"h-full bg-gray-900 overflow-hidden",children:[e.jsx("div",{className:"flex-shrink-0 p-6 border-b border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-white",children:"Tác nhận tự động"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Quản lý tác nhận tự động"})]}),e.jsxs("button",{onClick:o,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm font-medium transition-colors flex items-center space-x-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),e.jsx("span",{children:"Tạo Mới"})]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:l.length===0?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-800 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),e.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Chưa có quy tắc tự động nào"}),e.jsx("p",{className:"text-gray-400 max-w-md mb-4",children:"Tạo quy tắc tự động để hệ thống có thể thực hiện các tác vụ một cách tự động dựa trên điều kiện bạn đặt ra."}),e.jsx("button",{onClick:o,className:"px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:"Tạo Quy tắc Đầu tiên"})]})}):e.jsx("div",{className:"space-y-4",children:l.map(n=>e.jsx(R,{rule:n,onToggle:()=>i(n.id),onEdit:()=>d(n.id),onDelete:()=>c(n.id)},n.id))})})]})},$=()=>{const{state:t,dispatch:s}=p(),{activeSection:a,leftNavCollapsed:r,rightSidebarVisible:l}=t.ui,{sources:o}=t.chat,i=()=>{s({type:"SET_RIGHT_SIDEBAR_VISIBLE",payload:!l})},d=()=>{switch(a){case"chatbox":return e.jsx(y,{});case"mcp":return e.jsx(_,{});case"autoconnect":return e.jsx(I,{});default:return e.jsx(y,{})}},c=()=>a==="chatbox"?e.jsx(M,{visible:l,content:"sources",sources:o}):null;return e.jsx(S,{activeSection:a,leftNavCollapsed:r,rightSidebarVisible:l,leftNavigation:e.jsx(T,{}),rightSidebar:c(),onToggleRightSidebar:i,children:d()})},B=()=>e.jsx(k,{children:e.jsx($,{})}),v=document.getElementById("sidepanel-root");v&&N(v).render(e.jsx(B,{}));
